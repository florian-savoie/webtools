{% set title = 'client acceuil' %}
{% extends "./layout/layout_nav.html.twig" %}
{% block css %}
    <link rel="stylesheet" href="../../assets/vendor/css/pages/ui-carousel.css"/>
    <link rel="stylesheet" href="../../assets/vendor/libs/swiper/swiper.css"/>
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Flipster CSS -->
    <link rel="stylesheet" href="dist/jquery.flipster.min.css">

    <link rel="stylesheet" href="../assets/css/time-line.css">
    <!-- Flipster Js -->
    <script src="dist/jquery.flipster.min.js"></script>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com"/>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet"/>
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="../../assets/img/favicon/favicon.ico"/>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com"/>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
    <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
            rel="stylesheet"/>

    <!-- Icons -->
    <link rel="stylesheet" href="../../assets/vendor/fonts/materialdesignicons.css"/>
    <link rel="stylesheet" href="../../assets/vendor/fonts/fontawesome.css" /
    <!-- Icons -->
    <link rel="stylesheet" href="../../assets/vendor/fonts/materialdesignicons.css"/>
    <link rel="stylesheet" href="../../assets/vendor/fonts/fontawesome.css"/>

    <!-- Core CSS -->
    <link rel="stylesheet" href="../../assets/vendor/css/rtl/core.css" class="template-customizer-core-css"/>
    <link rel="stylesheet" href="../../assets/vendor/css/rtl/theme-default.css" class="template-customizer-theme-css"/>
    <link rel="stylesheet" href="../../assets/css/demo.css"/>

    <!-- Vendors CSS -->
    <link rel="stylesheet" href="../../assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.css"/>
    <link rel="stylesheet" href="../../assets/vendor/libs/node-waves/node-waves.css"/>
    <link rel="stylesheet" href="../../assets/vendor/libs/typeahead-js/typeahead.css"/>
    <link rel="stylesheet" href="../../assets/vendor/libs/bs-stepper/bs-stepper.css"/>
    <link rel="stylesheet" href="../../assets/vendor/libs/select2/select2.css"/>
    <link rel="stylesheet" href="../../assets/vendor/libs/tagify/tagify.css"/>
    <link rel="stylesheet" href="../../assets/vendor/libs/flatpickr/flatpickr.css"/>
    <link rel="stylesheet" href="../../assets/vendor/libs/formvalidation/dist/css/formValidation.min.css"/>
    <!-- Vendors CSS -->

    <link rel="stylesheet" href="../../assets/vendor/libs/rateyo/rateyo.css"/>
    <!-- Page CSS -->

    <!-- Helpers -->
    <script src="../../assets/vendor/js/helpers.js"></script>


    <!-- Inclusion de la bibliothèque jQuery -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <!-- Inclusion de la bibliothèque JavaScript de Bootstrap -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.min.js"></script>

    <!--! Template customizer & Theme config files MUST be included after core stylesheets and helpers.js in the <head> section -->
    <!--? Template customizer: To hide customizer set displayCustomizer value false in config.js.  -->
    <script src="../../assets/vendor/js/template-customizer.js"></script>
    <!--? Config:  Mandatory theme config file contain global vars & default theme options, Set your preferred theme option in this file.  -->
    <script src="../../assets/js/config.js"></script>

{% endblock %}
{% block contenu %}
    <!-- Content -->
    <!-- Users List Table -->
    <div class="row col-12 mt-5">

        <div class="col-2 mt-5" style="background: radial-gradient(circle, rgba(241,224,232,1) 0%, rgba(180,207,242,0.10407913165266103) 100%) ; border: solid 2px black
            ;border-radius: 2rem
            ;
">


            <div id="accordion">
                {% for categorie in categories %}
                    <div class="card">
                        <div class="card-header d-flex justify-content-between"
                             style=" width: 100%;background: radial-gradient(circle, rgba(241,224,232,1) 0%, rgba(180,207,242,0.10407913165266103) 100%)">
                            <a class="btn col-10 " href="?category={{ categorie.id }}">
                                <span style="color: {{ categorie.color }}">{{ categorie.name }}</span>
                                {% set souscat = false %}
                                {% set lessouscats = [] %}
                                {% for souscategorie in souscategories %}
                                    {% if souscategorie.category_id == categorie.id %}
                                        {% set souscat = true %}
                                        {% set lessouscats = lessouscats|merge([souscategorie]) %}
                                    {% endif %}
                                {% endfor %}
                                {% if souscat %}
                                    <a data-bs-toggle="collapse" class="col-2 "  href="#accordion{{ categorie.id }}"><img
                                                src="../../assets/img/webtools/fleche-vers-le-bas.png" class="ms-4">
                                    </a> {% endif %}

                            </a>
                        </div>
                        <div id="accordion{{ categorie.id }}" class="collapse" data-bs-parent="#accordion">
                            <div class="card-body">
                                {% for souscategorie in lessouscats %}
                                    <a class="btn col-10" href="?category={{ categorie.id }}&souscat={{ souscategorie.id }}">  <span style="color: {{ categorie.color }}">{{ souscategorie.name }}</span> <br>
                               </a> {% endfor %}
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>


        </div>
        <div class="col-10 mt-5">
            <div class="row">
                <!-- Finance App -->
                {% for article in articles %}
                    <div class="col-lg-4 col-xl-3 mb-3" style="height: 500px;">
                        <div class="card h-100">
                            <img class="card-img-top" style="height: 190px ;min-height: 190px "
                                 src="{{ article.image }}" alt="iPhone-bg"/>
                            <div class="card-body ">
                                <div class="d-flex align-items-center justify-content-between mb-3"
                                     style="height: 35px">
                                    <div class="d-flex ">
                                        <div class="badge bg-label-success rounded-pill me-3">article</div>
                                        <div class="badge bg-label-danger rounded-pill">React</div>

                                    </div>
                                    <div>
                                        <p class="text-muted fw-semibold mt-2">{{ article.submission_date |date("m/d/Y") }}</p>
                                    </div>


                                </div>
                                <h4 class="mb-1 text-center" style="height: 35px">{{ article.title }}</h4>
                                <p class="text-muted my-2" style=" height: 120px; overflow: hidden ">
                                    {{ article.content }}
                                </p>


                                <!-- Events-->

                                <div class="row mb-1 col-12 ">
                                    <div class="col-12 d-flex flex-column justify-content-center  mb-sm-0 mb-3">
                                        <small class="text-light fw-semibold">Note :{{ article.rating }}</small>
                                        <div class="col-12 d-flex justify-content-between ">
                                            {% set voted = false %}
                                            {% set voteValue = 0 %}

                                            {% for vote in votes %}
                                                {% if vote.article_id == article.id %}
                                                    {% set voted = true %}
                                                    {% set voteValue = vote.vote %}
                                                {% endif %}
                                            {% endfor %}

                                            {% if voted %}
                                                <div class="onset-event-ratings" data-idArticle="{{ article.id }}"
                                                     data-note="{{ voteValue }}"></div>
                                            {% else %}
                                                <div class="onset-event-ratings" data-idArticle="{{ article.id }}"
                                                     data-note="0"></div>
                                            {% endif %}

                                            <div class="d-flex align-items-center justify-content-end">

                                                {% set liked = false %}

                                                {% for like in likes %}
                                                    {% if like.article_id == article.id %}          {% set liked = true %}
                                                    {% endif %}


                                                {% endfor %}   {% if liked %}
                                                    <span onclick="deletefavorite({{ article.id }})"
                                                          id="deletefavorite{{ article.id }}">💛</span>
                                                    <span onclick="addfavorite({{ article.id }})"
                                                          id="addfavorite{{ article.id }}" hidden>🤍 </span>
                                                {% else %}
                                                    <span onclick="deletefavorite({{ article.id }})"
                                                          id="deletefavorite{{ article.id }}" hidden>💛</span>
                                                    <span onclick="addfavorite({{ article.id }})"
                                                          id="addfavorite{{ article.id }}">🤍</span>

                                                {% endif %}


                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- /Events-->

                            </div>
                        </div>
                    </div>
                    <!--/ Finance App -->
                {% endfor %}
            </div>
        </div>
    </div>





{% endblock %}

        {% block js %}

            <script src="../assets/js/time-line/client/caroussel.js"></script>
            <script src="../assets/js/time-line/artisan/delete-like-photo.js"></script>
            <script src="../assets/js/time-line/artisan/like-photo.js"></script>
            <script src="../assets/js/time-line/artisan/envent-form.js"></script>
            <script src="../assets/js/time-line/artisan/compression-photo.js"></script>
            <script src="../../assets/vendor/assets/js/form-basic-inputs.js"></script>
            <script src="../../assets/vendor/assets/js/extended-ui-timeline.js"></script>
            <script src="../../assets/vendor/libs/swiper/swiper.js"></script>
            <!-- build:js assets/vendor/js/core.js -->
            <script src="../../assets/vendor/libs/jquery/jquery.js"></script>
            <script src="../../assets/vendor/libs/popper/popper.js"></script>
            <script src="../../assets/vendor/js/bootstrap.js"></script>
            <script src="../../assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.js"></script>
            <script src="../../assets/vendor/libs/node-waves/node-waves.js"></script>

            <script src="../../assets/vendor/libs/hammer/hammer.js"></script>
            <script src="../../assets/vendor/libs/i18n/i18n.js"></script>
            <script src="../../assets/vendor/libs/typeahead-js/typeahead.js"></script>

            <script src="../../assets/vendor/js/menu.js"></script>
            <!-- endbuild -->

            <!-- Vendors JS -->
            <script src="../../assets/vendor/libs/cleavejs/cleave.js"></script>
            <script src="../../assets/vendor/libs/cleavejs/cleave-phone.js"></script>
            <script src="../../assets/vendor/libs/bs-stepper/bs-stepper.js"></script>
            <script src="../../assets/vendor/libs/select2/select2.js"></script>
            <script src="../../assets/vendor/libs/tagify/tagify.js"></script>
            <script src="../../assets/vendor/libs/flatpickr/flatpickr.js"></script>
            <script src="../../assets/vendor/libs/formvalidation/dist/js/FormValidation.min.js"></script>
            <script src="../../assets/vendor/libs/formvalidation/dist/js/plugins/Bootstrap5.min.js"></script>
            <script src="../../assets/vendor/libs/formvalidation/dist/js/plugins/AutoFocus.min.js"></script>
            <!-- Page JS -->
            <script src="../../assets/js/extended-ui-star-ratings.js"></script>
            <!-- Main JS -->
            <script src="../../assets/js/main.js"></script>
            <!-- Core JS -->
            <!-- build:js assets/vendor/js/core.js -->
            <script src="../../assets/vendor/libs/jquery/jquery.js"></script>
            <script src="../../assets/vendor/libs/popper/popper.js"></script>
            <script src="../../assets/vendor/js/bootstrap.js"></script>
            <script src="../../assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.js"></script>
            <script src="../../assets/vendor/libs/node-waves/node-waves.js"></script>

            <script src="../../assets/vendor/libs/hammer/hammer.js"></script>
            <script src="../../assets/vendor/libs/i18n/i18n.js"></script>
            <script src="../../assets/vendor/libs/typeahead-js/typeahead.js"></script>

            <script src="../../assets/vendor/js/menu.js"></script>
            <!-- endbuild -->

            <!-- Vendors JS -->
            <script src="../../assets/vendor/libs/rateyo/rateyo.js"></script>

            <!-- Main JS -->
            <script src="../../assets/js/main.js"></script>

            <!-- Page JS -->
            <script src="../../assets/js/extended-ui-star-ratings.js"></script>
            <!-- Page JS -->

            <script src="../../assets/js/wizard-ex-property-listing.js"></script>
            <script>


            </script>
            <script src="../../assets/js/category/articles/votestar.js"></script>
            <script src="../../assets/js/category/articles/addfavorite.js"></script>
            <script src="../../assets/js/category/articles/deletefavorite.js"></script>


        {% endblock %}